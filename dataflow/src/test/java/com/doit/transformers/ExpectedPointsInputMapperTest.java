package com.doit.transformers;

import com.doit.domain.ExpectedPointsInput;
import lombok.Data;
import org.apache.beam.sdk.transforms.DoFn;
import org.joda.time.Instant;
import org.junit.Assert;
import org.junit.Test;

public class ExpectedPointsInputMapperTest extends Assert {

    @Test
    public void shouldCreateEpexctedPointsInputObject(){
        String testLine = "113,2009091000,PIT,TEN,PIT,home,TEN,PIT,56,2009-09-10,815,1715,3515,Half1,0,1,0,1,3,0,13:35,PIT 44,8,2,\"(13:35) (Shotgun) B.Roethlisberger pass incomplete deep right to M.Wallace, COVERAGE BY #24 HOPE\",pass,0,1,0,1,0,0,0,deep,right,34,NA,NA,NA,NA,NA,NA,NA,3,3,0,NA,NA,3,3,0,0,0,0,0,0,0,0,0.0014338646477691478,0.14908828017633333,0.0019439625133838576,0.23480084556603076,0.28933588304645974,0.004776405474203797,0.3186207585758195,0,0,1.0131470856005402,-1.7125834938947782,-1.0229622619055143,1.0229622619055143,-1.4027598314188185,1.4027598314188185,-1.6346763358781586,1.6346763358781586,3.4125723251720945,-5.1251558190668725,0,0,-0.9387353554295581,0.9387353554295581,1.0166425134461776,-1.0166425134461776,2.4738369697425364,-2.4738369697425364,-4.108513305620695,4.108513305620695,0.5107930906986009,0.4892069093013991,0.5107930906986009,0.4892069093013991,-0.0495759766871644,0.4612171140114365,0.5387828859885635,-0.04029472646288734,0.04029472646288734,-0.04492099923797388,0.04492099923797388,0.10992541689995661,-0.159501393587121,0,0,-0.0283833736796667,0.0283833736796667,0.033038351128857224,-0.033038351128857224,0.0815420432202899,-0.0815420432202899,-0.12646304245826379,0.12646304245826379,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,00-0022924,B.Roethlisberger,00-0026901,M.Wallace,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0,NA,NA,NA,NA,0,NA,NA,0,0,0,0";

        TestOutputReceiveer<ExpectedPointsInput> r = new TestOutputReceiveer<ExpectedPointsInput>();
        ExpectedPointsInputMapper mapper = new ExpectedPointsInputMapper();

        mapper.processElement(testLine, r);
        assertNotNull(r.getGeneratedObject());
    }
}
